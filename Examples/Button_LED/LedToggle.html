<html>
  <head>
    <title>LedToggle Guida</title>
    <meta charset="UTF-8">
    <meta name="author" content="Filippo Finke">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <h1>Esempio LedToggle</h1>
    <hr>
    <h2>Descrizione</h2>
    <p>
      Circuito nel quale viene mostrato l'utilizzo di un bottone per accendere e spegnere un led con mantenimento.
    </p>
    <hr>
    <h2>Materiale</h2>
    <ul>
      <li>Un Digispark</li>
      <li>Un led</li>
      <li>Un bottone</li>
      <li>Una resistenza da 330Ω</li>
      <li>Una resistenza da 10KΩ</li>
    </ul>
    <hr>
    <h2>Schema</h2>
    <h3>Descrizione del funzionamento</h3>
    <p>All’interno del circuito sono presenti quattro componenti: 1 bottone, 1 LED e 2 resistenze. Il bottone è in pull-down tramite una resistenza da 10kΩ, il suo stato viene letto attraverso il pin “P0” del micro controllore. Il LED è attaccato al pin “P1” del Digispark attraverso una resistenza da 330Ω. Quando il bottone viene premuto il LED al pin "P1" si accende e se si rilascia il bottone il LED rimane acceso. Se si ripreme sul bottone il LED si spegne.</p>
    <img src="../../Images/Circuit diagrams/ButtonLed_bb.svg" alt="ButtonLed">
    <hr>
    <h2>Codice</h2>
    <pre>
/* Includo la libreria button */
#include &#x3C;button.h&#x3E;
/* Includo la led button */
#include &#x3C;led.h&#x3E;

/* Istanzio un oggetto di tipo led */
Led led(1);
/* Istanzio un oggetto di tipo button */
Button b(0);

/* Variabile nel quale viene salvato l&#x27;ultimo stato del bottone. */
bool lastButtonState = LOW;

/* Variabile nel quale viene salvato il tempo del click sul bottone. */
int time = millis();

/* Metodo che viene chiamato solo all&#x27;avvio */
void setup() {
}

/* Metodo che viene chiamato all&#x27;infinito */
void loop() {
  /* Prendo lo stato del bottone */
  bool state = b.getState();

  /* Se il bottone &#xE8; premuto accendo il led e al prossimo cambiamento spengo il led. */
  if(state &#x26;&#x26; !lastButtonState &#x26;&#x26; millis() - time &#x3E; 200) {
    lastButtonState = HIGH;
    led.toggle();
    time = millis();
  } else if(!state &#x26;&#x26; lastButtonState) {
    lastButtonState = LOW;
  }
}
    </pre>
  </body>
</html>
